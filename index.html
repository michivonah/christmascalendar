<!DOCTYPE html>
<html lang="en">
<head>
         <title>Christmascalendar</title>
         <meta name="apple-mobile-web-app-title" content="Christmascalendar">
         <link rel="icon" type="image/png" href="https://cdn.pixabay.com/photo/2016/09/14/20/48/birthday-1670415_960_720.png">
         <link rel="shortcut icon" type="image/svg+xml" href="icons/favicon.svg">
         <link rel="apple-touch-icon" href="icons/favicon.svg" sizes="any">
         <link rel="icon" type="image/svg+xml" href="icons/favicon.svg" sizes="any">
         <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
         <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css">
         <link rel="stylesheet" type="text/css" href="style.css"/>
         <meta charset="UTF-8">
         <meta name="theme-color" content="#000000">
         <meta name="apple-mobile-web-app-status-bar-style" content="#ffffff">
         <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
         <meta name="mobile-web-app-capable" content="yes">
         <meta name="apple-mobile-web-app-capable" content="yes">
         <link rel="manifest" href="manifest.json">
         <link rel="preconnect" href="https://fonts.gstatic.com">
         <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
         <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas&display=swap" rel="stylesheet">
</head>
<body>

          <!-- Loadingscreen -->
      <div id="loading-screen">
        <div id="loading"><img src="https://michivonah.github.io/christmascalendar/loading-icon.png"></div>
      </div>

      <div id="content">
        <div id="home">
          <h1 id="calendartitle">Christmascalendar <i class="fas fa-gifts"></i></h1>
          <a href="#"><p id="creatorsname">by Michi</p></a>
        </div>
        <div id="doors">
          <div class="door 1"><p>1</p></div>
          <div class="door 2"><p>2</p></div>
          <div class="door 3"><p>3</p></div>
          <div class="door 4"><p>4</p></div>
          <div class="door 5"><p>5</p></div>
          <div class="door 6"><p>6</p></div>
          <div class="door 7"><p>7</p></div>
          <div class="door 8"><p>8</p></div>
          <div class="door 9"><p>9</p></div>
          <div class="door 10"><p>10</p></div>
          <div class="door 11"><p>11</p></div>
          <div class="door 12"><p>12</p></div>
          <div class="door 13"><p>13</p></div>
          <div class="door 14"><p>14</p></div>
          <div class="door 15"><p>15</p></div>
          <div class="door 16"><p>16</p></div>
          <div class="door 17"><p>17</p></div>
          <div class="door 18"><p>18</p></div>
          <div class="door 19"><p>19</p></div>
          <div class="door 20"><p>20</p></div>
          <div class="door 21"><p>21</p></div>
          <div class="door 22"><p>22</p></div>
          <div class="door 23"><p>23</p></div>
          <div class="door 24"><p>24</p></div>
        </div>
        <div id="footer">
          <a href="https://github.com/michivonah/christmascalendar">Github</a>
        </div>
      </div>

      <div class="alert toearly">
        <h1>Oh no!</h1>
        <p>You can't open this door today. You are to early for this.</p>
        <i class="fas fa-times-circle close-btn"></i>
      </div>

      <div class="alert open-door">
        <h1 id="day-num">Day 1</h1>
        <p id="day-content">Content</p>
        <img id="day-img" src="background.jpg">
        <a id="day-link" href="#"><button id="day-btn">Open Link!</button></a>
        <iframe src="#" frameborder="0" allowtransparency="true" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen id="day-iframe"></iframe>
        <i class="fas fa-times-circle close-btn"></i>
      </div>

      <div class="alert info">
        <h1>About</h1>
        <p>This is a free to use and open source online christmascalendar. You can create your own calendar with the introductions on Github.</p>
        <p>Version 1.4.0</p>
        <a href="https://github.com/michivonah/christmascalendar"><button>Github <i class="fab fa-github"></i></button></a>
        <i class="fas fa-times-circle close-btn"></i>
      </div>

      <a href="#"><div id="scroll-top" class="fixed-btns">
        <i class="fas fa-chevron-up"></i>
      </div></a>

      <div id="info-btn" class="fixed-btns">
        <i class="fas fa-infinity"></i>
      </div>



      <script>
      // Loading
      $(window).on("load", function(){
        $("#loading-screen").fadeOut(750);
        $('.fixed-btns').css('display', 'none');
        if(window.location.search != ''){
          var url = window.location.search;
          var jsonurl = url.replace('?data=', '');
          console.log("Load data from: " + jsonurl);
        }
        else{
          var jsonurl = "https://michivonah.github.io/christmascalendar/defaultcalendar.json";
        }
        $.getJSON(jsonurl, function(data) {
          $("#creatorsname").text("by " + data.creatorsname);
          document.getElementById("creatorsname").href = data.creatorsurl;
          $("#calendartitle").text(data.title + " 🎁");
           document.body.style.backgroundImage = "url('" + data.background + "')";
           $("#calendartitle").css('color', data.textcolor);
           $("#creatorsname").css('color', data.textcolor);
        });

        var getdate = new Date();
        var day = getdate.getDate();
        console.log(getdate);
        var dayclass = "." + day;
        $(dayclass).css("background", "#9b59b6");
        if(day >= 24){
          $("#day-num").text("Dear Christmas friend");
          $("#day-content").text("This year, Christmas Eve is already over. So you can now open all the doors at once if you want. You now have enough time to create your own advent calendar for next year with this tool. You can find out how to do this on Github, just click on the button below. See you next December.");
          $("#day-btn").text("Go to Github!");
          document.getElementById("day-link").href = "https://github.com/michivonah/christmascalendar#readme";
          $('.open-door').css('display', 'block');
        }

      });

      // open the door script
      $(".door").click(function(){
        var doornum = this.className.replace('door ', '').replace(' past', '').replace('today', '').replace('future', '');
        var getdate = new Date();
        var h = getdate.getHours();
        var min = getdate.getMinutes();
        var day = getdate.getDate();
        var month = getdate.getMonth();
        console.log(getdate);

        if(day >= doornum){
          console.log("Door " + doornum + " clicked.");
          this.classList.add("past");
          if(window.location.search != ''){
            var url = window.location.search;
            var jsonurl = url.replace('?data=', '');
            console.log("Load data from: " + jsonurl);
          }
          else{
            var jsonurl = "https://michivonah.github.io/christmascalendar/defaultcalendar.json";
          }
          // get the data from json file
          $.getJSON(jsonurl, function(data) {
            var link = data.links[doornum].link;
            console.log("Link of the door " + doornum + " is " + link + ".");
            $("#day-num").text("Day " + doornum);
            $("#day-content").text(data.links[doornum-1].text);
            $("#day-btn").text(data.links[doornum-1].buttontext);
            document.getElementById("day-link").href = data.links[doornum-1].link;
            // check wheter the link is a spotify or youtube link
            if(data.links[doornum-1].link.includes('https://open.spotify.com/')){
              var iframelink = data.links[doornum-1].link.replace('https://open.spotify.com/', 'https://open.spotify.com/embed/');
              document.getElementById("day-iframe").src = iframelink;
              $('#day-iframe').css('height', '80px');
              $('#day-iframe').css('display', 'block');
            }
            else if(data.links[doornum-1].link.includes('https://youtube.com/watch') || data.links[doornum-1].link.includes('https://youtu.be/')){
              var iframelink = data.links[doornum-1].link.replace('https://youtube.com/watch?v=', 'https://youtube.com/embed/');
              var iframelink = data.links[doornum-1].link.replace('https://youtu.be/', 'https://youtube.com/embed/');
              document.getElementById("day-iframe").src = iframelink;
              $('#day-iframe').css('height', '315px');
              //$('#day-iframe').css('display', 'block');
            }
            // check whether a picture is available
            if(data.links[doornum-1].image !== "#"){
              document.getElementById("day-img").src = data.links[doornum-1].image;
              $('#day-img').css('display', 'block');
              //$("#day-num").text(data.links[doornum-1].image);
            }
            else if(data.links[doornum-1].image !== ""){
              $('#day-img').css('display', 'none');
            }
            else{
              $('#day-img').css('display', 'none');
            }
            // show the door content
            $('.open-door').css('display', 'block');
          });
        }
        else{
          // the door can't opened today
          console.log("Door " + doornum + " clicked.");
          console.log("Oh no, you are to early to open this door.");
          $('.toearly').css('display', 'block');
        }
       });

       $(".close-btn").click(function(){
         $('.alert').css('display', 'none');
         $('.open-door').css('display', 'none');
         $('#day-img').css('display', 'none');
         $('#day-iframe').css('display', 'none');
         $('.info').css('display', 'none');
       });

       // fixed buttons
       $(window).scroll(function(){
        if(this.scrollY > 20){
          $('.fixed-btns').css('display', 'flex');
        }
        else{
          $('.fixed-btns').css('display', 'none');
        }
      });

      $("#info-btn").click(function(){
        $('.info').css('display', 'block');
      });
      </script>
</body>
</html>
